const t=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):e},e=(t,e)=>Array.from(e).reduce(((e,s)=>(Object.keys(t).includes(s)&&(e[s]=t[s]),e)),{}),s=(t,s)=>{let r=localStorage.getItem(t);if(r)return e(JSON.parse(r),s)},r=(t,e)=>localStorage.setItem(t,JSON.stringify(e)),i=(e,s)=>{let i=t(e);i=i||{},Object.entries(s).forEach((([t,e])=>i[t]=e)),(t=>{localStorage.removeItem(t)})(e),r(e,i)},a=(t,e)=>{const s=(t,e)=>r(t)&&r(e),r=t=>t&&"object"==typeof t;return!(!s(t,e)||Object.values(t).length!==Object?.values(e).length)&&Object.entries(t).every((([t,r],i)=>{const[o,n]=Object.entries(e)[i];return s(r,n)?((t,e)=>t===e)(t,o)&&a(r,n):t===o&&r===n}))};class o{#t;#e;#s;constructor(t,{storageName:r,keys:a}={}){if(this.#s="object"==typeof t?t:t?{state:t}:{},this.#t=new Set,this.#e=void 0,r&&a){this.#e={storageName:r,keys:a};const t=s(r,a);t?this.setState(t,!0):i(r,e(this.#s,a))}}subscribe(t){return this.#t.add(t),()=>this.#t.delete(t)}destroy(){this.#t.clear()}getState(t){return t?this.#s[t]:this.#s}setState(t,s){if(!t)return;const r="function"==typeof(t="object"==typeof t||"function"==typeof t?t:{state:t})?t(this.#s):t;if(!a(r,this.#s)){const t=this.#s;this.#s=s?r:{...this.#s,...r},this.#e?.storageName&&this.#e?.keys&&i(this.#e.storageName,e(this.#s,this.#e.keys)),this.#t.forEach((e=>e(this.#s,t)))}}}export{o as Store,e as filterObjectByKeys,t as getLocalStorageState,s as getPartialStorage,a as objectsAreEqual,r as setLocalStorageState,i as setPartialStorage};
