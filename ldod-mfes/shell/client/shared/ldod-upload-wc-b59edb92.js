import t from"@shared/bootstrap/buttons-css.js";import e from"@shared/bootstrap/forms-css.js";import s from"@shared/bootstrap/root-css.js";import{u as i}from"./events-module-3a3c6117.js";import o from"@shared/request-proxy.js";import"@shared/ldod-events.js";class n extends HTMLElement{constructor(){super(),this.controller=new AbortController,this.attachShadow({mode:"open"}),this.sheet=new CSSStyleSheet,this.sheet.replaceSync(s+t+e+":host{display:block;min-width:350px}span.icon{float:left;margin-top:3px;width:15px;height:15px}span.icon-upload{background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23fff' d='M288 109.3V352c0 17.7-14.3 32-32 32s-32-14.3-32-32V109.3l-73.4 73.4c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3l128-128c12.5-12.5 32.8-12.5 45.3 0l128 128c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L288 109.3zM64 352H192c0 35.3 28.7 64 64 64s64-28.7 64-64H448c35.3 0 64 28.7 64 64v32c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V416c0-35.3 28.7-64 64-64zM432 456c13.3 0 24-10.7 24-24s-10.7-24-24-24s-24 10.7-24 24s10.7 24 24 24z'/%3E%3C/svg%3E\") no-repeat center;background-size:15px}span[label]{margin-left:5px}\n"),this.shadowRoot.adoptedStyleSheets=[this.sheet]}static get observedAttributes(){return["title","width"]}get title(){return this.getAttribute("title")}get isMultiple(){return this.hasAttribute("multiple")}get width(){return this.getAttribute("width")??""}get form(){return this.shadowRoot.querySelector("form")}connectedCallback(){this.render()}disconnectedCallback(){this.controller.abort()}render(){this.shadowRoot.innerHTML=(({title:t,isMultiple:e})=>`\n    <form enctype="multipart/form-data">\n    \n      <div class="input-group">\n        <input\n          ${e?"multiple":""}\n          required\n          type="file"\n          name=${e?"files":"file"}\n          class="form-control"\n          id="inputFile"\n          accept=".xml"\n        />\n        <button class="btn btn-primary" type="submit" id="loadBtn" disabled>\n          <span label>${t}</span>\n          <span class="icon icon-upload"></span>\n        </button>\n      </div>\n    </form>\n  `)({title:this.title,isMultiple:this.isMultiple}),this.addEventListeners()}addEventListeners=()=>{this.form.onsubmit=this.handleSubmit,this.form.oninput=this.handleInput};handleSubmit=async t=>{t.preventDefault();const e=new FormData(t.target),s=this.dataset.url,n=this.controller.signal,a=await o.upload({path:s,signal:n},e).catch((t=>console.error(t)));this.responseData=a,this.dispatchEvent(i(this.id,a))};handleInput=t=>{const e=t=>this.shadowRoot.querySelector("#loadBtn").toggleAttribute("disabled",t);if(t.target.value.endsWith(".xml")||t.target.value.endsWith(".XML"))return e(!1);e(!0)};attributeChangedCallback(t,e,s){this.handleChangeAttribute[t](e,s)}handleChangeAttribute={title:(t,e)=>{t&&t!==e&&(this.shadowRoot.querySelector("button#loadBtn>span[label]").textContent=this.title)},width:()=>{this.sheet.insertRule(`form > div {width: ${this.width};}`),this.shadowRoot.adoptedStyleSheets=[this.sheet]}}}!customElements.get("ldod-upload")&&customElements.define("ldod-upload",n);export{n as LdodUpload};
