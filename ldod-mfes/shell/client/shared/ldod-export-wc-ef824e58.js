import t from"@shared/bootstrap/buttons-css.js";import e from"@shared/bootstrap/root-css.js";import s from"@shared/request-proxy.js";import{e as i}from"./events-module-3a3c6117.js";import"@shared/ldod-events.js";class o extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.sheet=new CSSStyleSheet,this.sheet.replaceSync(e+t+":host{display:block}.ellipsis{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}span.icon{float:left;margin-top:5px;width:15px;height:15px}span.icon-export{background:url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3E%3Cpath fill='%23fff' d='M32 64C32 28.7 60.7 0 96 0H256V128c0 17.7 14.3 32 32 32H416V288H248c-13.3 0-24 10.7-24 24s10.7 24 24 24H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V64zM416 336V288H526.1l-39-39c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0l80 80c9.4 9.4 9.4 24.6 0 33.9l-80 80c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l39-39H416zm0-208H288V0L416 128z'/%3E%3C/svg%3E\") no-repeat center;background-size:15px}span[label]{margin-left:5px}button#exportBtn{width:100%}\n"),this.shadowRoot.adoptedStyleSheets=[this.sheet]}static get observedAttributes(){return["title","width"]}get title(){return this.getAttribute("title")}get width(){return this.getAttribute("width")??""}get filePrefix(){return this.getAttribute("file-prefix")}get fileType(){return this.getAttribute("file-type")}get method(){return this.getAttribute("method")||"GET"}connectedCallback(){this.render()}render(){this.shadowRoot.innerHTML=(({title:t})=>`\n    <button class="btn btn-primary ellipsis" type="button" id="exportBtn">\n      <span class="icon icon-export"></span>\n      <span label>${t}</span>\n    </button>\n  `)({title:this.title}),this.addEventListeners()}addEventListeners=()=>{this.shadowRoot.querySelector("button").onclick=this.handleSubmit};handleSubmit=async t=>{t.preventDefault();const e=await(s[this.method.toLowerCase()]?.({path:this.dataset.url,body:"POST"===this.method&&JSON.stringify(this.body)}));if(e&&!e.xmlData&&void 0!==e.ok)return void i("error",e.message);const o=new Blob([(n=e?.xmlData,new Uint8Array(atob(n).split("").map((t=>t.charCodeAt(0)))).buffer)],{type:`application/${this.fileType||"xml"}`}),r=document.createElement("a");var n;r.href=window.URL.createObjectURL(o),r.download=`${this.filePrefix}-${(new Date).getFullYear()}-${(new Date).getMonth()+1}-${(new Date).getDate()}.${this.fileType||"xml"}`,r.click()};attributeChangedCallback(t,e,s){this.handleChangeAttribute[t](e,s)}handleChangeAttribute={title:(t,e)=>{t&&t!==e&&(this.shadowRoot.querySelector("button#exportBtn>span[label]").textContent=this.title)},width:()=>{this.sheet.insertRule(`button {width: ${this.width};}`),this.shadowRoot.adoptedStyleSheets=[this.sheet]}}}!customElements.get("ldod-export")&&customElements.define("ldod-export",o);export{o as LdodExport};
