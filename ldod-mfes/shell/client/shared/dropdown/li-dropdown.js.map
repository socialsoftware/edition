{"version":3,"file":"li-dropdown.js","sources":["../../navbar-header/src/li-dropdown.js","../../navbar-header/src/data-schema-validator.js"],"sourcesContent":["/** @format */\nimport { addLiItem, createDropdownRawHTML } from './li-dropdown-html';\nimport { headerDataSchemaValidator } from './data-schema-validator';\n\nlet DropdownBS;\nconst loadDropdownJSModule = async () => {\n\tif (DropdownBS) return;\n\tDropdownBS = (await import('@shared/bootstrap/dropdown.js')).default;\n};\n\nexport class DropDown extends HTMLLIElement {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tget key() {\n\t\treturn this.getAttribute('key');\n\t}\n\n\tget language() {\n\t\treturn this.getAttribute('language');\n\t}\n\n\tget show() {\n\t\treturn this.hasAttribute('show');\n\t}\n\n\tget constants() {\n\t\treturn this.data.constants;\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['show', 'language', 'data-headers'];\n\t}\n\n\tattributeChangedCallback(name, oldValue, newValue) {\n\t\tthis.handleChangedAttribute[name](oldValue, newValue);\n\t}\n\thandleChangedAttribute = {\n\t\tshow: () => {\n\t\t\tthis.toggler.classList.toggle('show', this.show);\n\t\t\tthis.menu.classList.toggle('show', this.show);\n\t\t},\n\t\tlanguage: (oldValue, newValue) => {\n\t\t\tif (!this.data || !oldValue || oldValue === newValue) return;\n\t\t\tthis.querySelectorAll('[data-dropdown-key]').forEach(element => {\n\t\t\t\telement.textContent =\n\t\t\t\t\tthis.constants[this.language][element.dataset.dropdownKey] ||\n\t\t\t\t\telement.dataset.dropdownKey;\n\t\t\t});\n\t\t},\n\t\t'data-headers': (_, headersData) => {\n\t\t\tif (headersData) this.data = JSON.parse(headersData);\n\t\t\tthis.removeAttribute('data-headers');\n\t\t\tif (headerDataSchemaValidator(this.data)) this.render();\n\t\t},\n\t};\n\n\tconnectedCallback() {\n\t\tthis.render();\n\t}\n\n\trender = async () => {\n\t\tif (!this.data) return;\n\t\tif (!this.innerHTML) this.innerHTML = createDropdownRawHTML(this.data, this.language);\n\t\tthis.toggler = this.querySelector('a.dropdown-toggle');\n\t\tthis.menu = this.querySelector('ul.dropdown-menu');\n\t\tthis.externalLinks = this.menu.querySelector('div#external-links');\n\t\tthis.addEventListeners();\n\t};\n\n\taddEventListeners = () => {\n\t\twindow.addEventListener('pointermove', this.loadDropdownModule, { once: true });\n\t\tthis.toggler.addEventListener('click', e => {\n\t\t\te.stopPropagation();\n\t\t\tthis.dispatchEvent(new PointerEvent('click', { bubbles: true, composed: true }));\n\t\t});\n\t};\n\n\tonNewLink = ({ payload }) => {\n\t\tif (!payload) return;\n\t\tconst { replace = false, name, data, constants } = payload;\n\t\tif (name !== this.key) return;\n\t\tObject.entries(constants || {}).reduce((prev, [key, val]) => {\n\t\t\tprev[key] = { ...prev[key], ...val };\n\t\t\treturn prev;\n\t\t}, this.constants);\n\t\tconst itemsHTML = /*html*/ `\n\t\t\t${data.pages.reduce((html, page) => {\n\t\t\t\treturn html + addLiItem(page, this.language, this.constants);\n\t\t\t}, '')}\n\t\t`;\n\t\tif (replace) this.replaceExternalLinks(itemsHTML);\n\t\telse this.addMenuLinks(itemsHTML);\n\t};\n\n\treplaceExternalLinks = html => {\n\t\tthis.externalLinks.innerHTML = html;\n\t};\n\n\taddMenuLinks = html => {\n\t\tconst template = document.createElement('template');\n\t\ttemplate.innerHTML = html;\n\t\t[...template.content.cloneNode(true).children].forEach(node => {\n\t\t\tthis.externalLinks.insertAdjacentElement('beforebegin', node);\n\t\t});\n\t};\n\n\tloadDropdownModule = async () => {\n\t\tawait loadDropdownJSModule();\n\t\tthis.dropdown = new DropdownBS(this.querySelector('.dropdown-toggle'));\n\t};\n}\ncustomElements.define('drop-down', DropDown, { extends: 'li' });\n","/** @format */\n\nimport headerSchema from './header-data-schema.json';\nimport { ldodValidator } from '@shared/ldod-events.js';\n\nexport const headerDataSchemaValidator = data => {\n\tconst errors = ldodValidator.validate(data, headerSchema).errors;\n\tif (errors.length) {\n\t\terrors.forEach(error => console.error(error));\n\t\treturn false;\n\t}\n\treturn true;\n};\n"],"names":["DropdownBS","DropDown","HTMLLIElement","constructor","key","this","getAttribute","language","show","hasAttribute","constants","data","observedAttributes","attributeChangedCallback","name","oldValue","newValue","handleChangedAttribute","toggler","classList","toggle","menu","querySelectorAll","forEach","element","textContent","dataset","dropdownKey","_","headersData","JSON","parse","removeAttribute","errors","ldodValidator","validate","headerSchema","length","error","console","headerDataSchemaValidator","render","connectedCallback","async","innerHTML","createDropdownRawHTML","querySelector","externalLinks","addEventListeners","window","addEventListener","loadDropdownModule","once","e","stopPropagation","dispatchEvent","PointerEvent","bubbles","composed","onNewLink","payload","replace","Object","entries","reduce","prev","val","itemsHTML","pages","html","page","addLiItem","replaceExternalLinks","addMenuLinks","template","document","createElement","content","cloneNode","children","node","insertAdjacentElement","import","default","loadDropdownJSModule","dropdown","customElements","define","extends"],"mappings":"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"}