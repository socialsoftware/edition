class t extends HTMLElement{constructor(){super()}get location(){return s(location.pathname.toLowerCase())}get base(){return s(this.getAttribute("base"))}get routerPath(){if(this.location===this.base)return"/";const t=this.location.split(this.base)[1];return t&&h(t)}get outlet(){return this.querySelector("ldod-outlet")||document.createElement("ldod-outlet")}addBaseToPath=t=>`${this.base}${h(t)}`;isPathActive=t=>this.active&&h(this.active)===h(t);isFromThisRouter=t=>{if(!t)return;let e=s(t);return e===this.base||e.split(this.base)[1]&&!0};async connectedCallback(){this.append(this.outlet),this.addEventListeners(),this.navigate(this.location)}disconnectedCallback(){window.removeEventListener("ldod-url-changed",this.handleURLChanged),window.removeEventListener("popstate",this.handlePopstate)}addEventListeners(){window.addEventListener("ldod-url-changed",this.handleURLChanged),window.addEventListener("popstate",this.handlePopstate)}navigate=t=>{!o(t)&&this.isPathActive(t)||(this.location!==n(t)&&history.pushState({},void 0,this.addBaseToPath(t)),this.render())};handleURLChanged=({detail:{path:t}})=>{this.isFromThisRouter(this.addBaseToPath(t))&&this.navigate(t)};handlePopstate=t=>{this.isFromThisRouter(this.location)&&this.navigate(this.location)};async render(){const t=this.routes?.[this.routerPath];if(!t)return void(this.routes["not-found"]&&this.navigate("not-found"));if(await e(t))return;this.active&&await this.remove();(await t()).mount(this.language||this.getAttribute("language"),`ldod-router#${this.id}>ldod-outlet`),this.active=this.routerPath}async remove(){const t=this.routes?.[h(this.active)];t&&(await t()).unMount()}}const e=async t=>{if("function"!=typeof t)return!0;const e=await t();return!e.mount||!e.unMount||("function"!=typeof e.mount||"function"!=typeof e.unMount)};customElements.define("ldod-router",t);const s=t=>i(n(t)),i=t=>t.startsWith("/")?t:`/${t}`,n=t=>t.endsWith("/")?t:`${t}/`,o=t=>a(t).endsWith("/not-found"),a=t=>t.endsWith("/")?t.substring(0,t.length-1):t,h=t=>(t=>t.startsWith("/")?t.substring(1):t)(a(t));class r extends HTMLAnchorElement{constructor(){super()}get to(){return this.getAttribute("to")}connectedCallback(){this.addEventListener("click",this.onclick)}onclick(t){t.preventDefault(),this.emittURLEvent()}emittURLEvent(){this.dispatchEvent(new CustomEvent("ldod-url-changed",{composed:!0,bubbles:!0,detail:{path:this.to}}))}}customElements.define("nav-to",r,{extends:"a"});
