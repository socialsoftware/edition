class t extends HTMLElement{constructor(){super()}get location(){const t=location.pathname;return"/"!==t&&t.endsWith("/")?t.substring(0,t.length-1).toLowerCase():t.toLowerCase()}get base(){return this.getAttribute("base")??"/"}get routerPath(){if(this.location===this.base)return this.location;const t=this.location.split(this.base)[1];return t&&(t.startsWith("/")?t:`/${t}`)}get outlet(){return this.querySelector("ldod-outlet")||document.createElement("ldod-outlet")}isNotFound=t=>"/not-found"!==t;isPathActive=t=>this.active===t;isFromThisRouter=t=>t&&(t===this.base||t.split(this.base)[1]&&!0);async connectedCallback(){this.append(this.outlet),this.addEventListeners(),this.navigate(this.location)}disconnectedCallback(){window.removeEventListener("ldod-url-changed",this.handleURLChanged),window.removeEventListener("popstate",this.handlePopstate)}addEventListeners(){window.addEventListener("ldod-url-changed",this.handleURLChanged),window.addEventListener("popstate",this.handlePopstate)}navigate=t=>{this.isNotFound(t)&&this.active&&this.isPathActive(t)||(this.location!==t&&history.pushState({},void 0,t),this.render())};handleURLChanged=({detail:{path:t}})=>{this.isFromThisRouter(t)&&this.navigate(t)};handlePopstate=t=>{this.isFromThisRouter(this.location)&&this.navigate(this.location)};async render(){const t=this.routes?.[this.routerPath];if(!t)return void(this.routes["/not-found"]&&this.navigate("/not-found"));if(await e(t))return;this.active&&await this.remove();(await t()).mount(this.language||this.getAttribute("language"),`ldod-router#${this.id}>ldod-outlet`),this.active=this.routerPath}async remove(){const t=this.routes?.[this.active];t&&(await t()).unMount()}}const e=async t=>{if("function"!=typeof t)return!0;const e=await t();return!e.mount||!e.unMount||("function"!=typeof e.mount||"function"!=typeof e.unMount)};customElements.define("ldod-router",t);class i extends HTMLAnchorElement{constructor(){super()}get to(){return this.getAttribute("to")}connectedCallback(){this.addEventListener("click",this.onclick)}onclick(t){t.preventDefault(),this.emittURLEvent()}emittURLEvent(){this.dispatchEvent(new CustomEvent("ldod-url-changed",{composed:!0,bubbles:!0,detail:{path:this.to}}))}}customElements.define("nav-to",i,{extends:"a"});
