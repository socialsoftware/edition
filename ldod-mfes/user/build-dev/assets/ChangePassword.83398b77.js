import{createElement as t,createFragment as u}from"http://localhost:9000/ldod-mfes/shared/vanilla-jsx.js";import{P as d,a as n,c as r,e as o}from"./constants.030263b8.js";import{g as l,l as h,a as m,i as g,e as c,b as p,c as v}from"./index.148fe27f.js";import{navigateTo as w}from"http://localhost:9000/ldod-mfes/shared/router.js";import"http://localhost:9000/ldod-mfes/shared/store.js";import"http://localhost:9000/ldod-mfes/shared/fetcher.js";class y extends HTMLElement{constructor(){super(),this.isValid=!0,this.username=l().user?.username,this.current={value:"",test:e=>e&&!0,message:()=>this.getConstants("required")},this.new={value:"",test:e=>d.test(e)&&e!==this.current.value,message:()=>this.getConstants("minCurrent")},this.confirm={value:"",test:e=>e&&e===this.new.value,message:()=>this.getConstants("confirmPattern")}}static get observedAttributes(){return["language"]}get language(){return this.getAttribute("language")}async connectedCallback(){if(await this.setConstants(),!l().user)return w("/user/signin",this);this.appendChild(this.getComponent())}attributeChangedCallback(e,s,a){e==="language"&&s&&a!==s&&this.updateLanguage()}disconnectedCallback(){}setConstants=async()=>this.constants=await h(this.language);getConstants(e){return this.constants[e]}async updateLanguage(){await this.setConstants(),["[key]","[key],[placeholder]"].forEach(e=>this.querySelectorAll(e).forEach(s=>{if(s instanceof HTMLInputElement)return s.placeholder=this.getConstants(s.getAttribute("key"));s.innerHTML=this.getConstants(s.getAttribute("key"))})),m({language:this.language})}handleSubmit=async e=>{e.preventDefault(),this.checkInputs(),this.isValid&&(await g({username:this.username,currentPassword:this.current.value,newPassword:this.new.value,retypedPassword:this.confirm.value}).then(s=>c(this.getConstants(s.message))).catch(s=>c(this.getConstants(s.message),"error")),this.clearDataInputs(),this.clearStyleInputs()),this.isValid=!0};checkInputs=()=>{const e=s=>this.querySelector(`input[name=${s}]`);["current","new","confirm"].forEach(s=>{let a=this[s];if(!a.test(a.value))return this.isValid=!1,p(e(s),a.message());v(e(s))})};clearDataInputs(){this.querySelectorAll("input[type=password]").forEach(e=>{e.value="",this[e.name].value=""})}clearStyleInputs(){this.querySelectorAll(".form-control").forEach(e=>e.classList.remove("valid","invalid"))}revealPassword=({target:e})=>e.parentElement.querySelector("input").type="text";hidePassword=({target:e})=>e.parentElement.querySelector("input").type="password";getComponent(){return t(u,null,t("div",{class:"row"},t("h3",{key:"change-password"},this.getConstants("change-password"))),t("div",{class:"row"},t("form",{onSubmit:this.handleSubmit,role:"form",class:"form"},t("input",{name:"username",autoComplete:"username",type:"hidden",value:this.username}),t("div",{class:"col-md-offset-4 col-md-4"},t("div",{class:"form-control"},t("input",{key:"current",name:"current",type:"password",autoComplete:"current-password",value:this.current.value,onKeyUp:({target:{value:e}})=>this.current.value=e,placeholder:this.getConstants("current")}),t("img",{src:n,alt:"eye icon",class:"icon",onMouseDown:this.revealPassword,onMouseUp:this.hidePassword}),t("img",{src:r,class:"icon-validation valid"}),t("img",{src:o,class:"icon-validation invalid"}),t("small",{key:"required"}))),t("div",{class:"col-md-offset-4 col-md-4"},t("div",{class:"form-control"},t("input",{key:"new",name:"new",type:"password",autoComplete:"new-password",value:this.new.value,onKeyUp:({target:{value:e}})=>this.new.value=e,placeholder:this.getConstants("new")}),t("img",{src:n,alt:"eye icon",class:"icon",onMouseDown:this.revealPassword,onMouseUp:this.hidePassword}),t("img",{src:r,class:"icon-validation valid"}),t("img",{src:o,class:"icon-validation invalid"}),t("small",{key:"minCurrent"}))),t("div",{class:"col-md-offset-4 col-md-4"},t("div",{class:"form-control"},t("input",{key:"confirm",name:"confirm",type:"password",autoComplete:"new-password",onKeyUp:({target:{value:e}})=>this.confirm.value=e,value:this.confirm.value,placeholder:this.getConstants("confirm")}),t("img",{src:n,alt:"eye icon",class:"icon",onMouseDown:this.revealPassword,onMouseUp:this.hidePassword}),t("img",{src:r,class:"icon-validation valid"}),t("img",{src:o,class:"icon-validation invalid"}),t("small",{key:"confirmPattern"}))),t("div",{class:"form-group row"},t("div",{class:"col-sm-12"},t("button",{key:"update",class:"btn btn-primary",type:"submit"},this.getConstants("update")))))))}}!customElements.get("change-password")&&customElements.define("change-password",y);const E=(i,e)=>{document.querySelector(e).appendChild(t("change-password",{language:i}))},q=()=>document.querySelector("change-password")?.remove(),M="/change-password";export{E as mount,M as path,q as unMount};
